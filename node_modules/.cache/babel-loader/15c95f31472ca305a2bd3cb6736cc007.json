{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/* eslint-disable no-undef */\n\nvar js_sha3_1 = require(\"js-sha3\");\n\nvar index_1 = require(\"./index\");\n\nvar elliptic_1 = require(\"elliptic\");\n\nvar secp256k1 = new elliptic_1.ec('secp256k1');\n\nvar bytesLength = function (a) {\n  return (a.length - 2) / 2;\n};\n\nvar bytesSlice = function (i, j, bs) {\n  return '0x' + bs.slice(i * 2 + 2, j * 2 + 2);\n};\n\nvar bytesToNumber = function (hex) {\n  return parseInt(hex.slice(2), 16);\n};\n\nvar decodeSignature = function (hex) {\n  return [bytesSlice(64, bytesLength(hex), hex), bytesSlice(0, 32, hex), bytesSlice(32, 64, hex)];\n};\n\nvar toChecksum = function (address) {\n  var addressHash = js_sha3_1.keccak256(address.slice(2));\n  var checksumAddress = '0x';\n\n  for (var i = 0; i < 40; i++) {\n    checksumAddress += parseInt(addressHash[i + 2], 16) > 7 ? address[i + 2].toUpperCase() : address[i + 2];\n  }\n\n  return checksumAddress;\n};\n\nexports.hashMessage = function (message) {\n  var messageBytes = index_1.hexToBytes(Buffer.from(message, 'utf8').toString('hex'));\n  var messageBuffer = Buffer.from(messageBytes);\n  var preamble = '\\x19Ethereum Signed Message:\\n' + messageBytes.length;\n  var preambleBuffer = Buffer.from(preamble);\n  var ethMessage = Buffer.concat([preambleBuffer, messageBuffer]);\n  return '0x' + js_sha3_1.keccak256(ethMessage.toString());\n};\n\nexports.recover = function (message, signature) {\n  var hash = exports.hashMessage(message);\n  var vals = decodeSignature(signature);\n  var vrs = {\n    v: bytesToNumber(vals[0]),\n    r: vals[1].slice(2),\n    s: vals[2].slice(2)\n  };\n  var ecPublicKey = secp256k1.recoverPubKey(Buffer.from(hash.slice(2), 'hex'), vrs, vrs.v < 2 ? vrs.v : 1 - vrs.v % 2);\n  var publicKey = '0x' + ecPublicKey.encode('hex', false).slice(2);\n  var publicHash = '0x' + js_sha3_1.keccak256(index_1.hexToBytes(publicKey));\n  return toChecksum('0x' + publicHash.slice(-40));\n};","map":{"version":3,"names":["Object","defineProperty","exports","value","js_sha3_1","require","index_1","elliptic_1","secp256k1","ec","bytesLength","a","length","bytesSlice","i","j","bs","slice","bytesToNumber","hex","parseInt","decodeSignature","toChecksum","address","addressHash","keccak256","checksumAddress","toUpperCase","hashMessage","message","messageBytes","hexToBytes","Buffer","from","toString","messageBuffer","preamble","preambleBuffer","ethMessage","concat","recover","signature","hash","vals","vrs","v","r","s","ecPublicKey","recoverPubKey","publicKey","encode","publicHash"],"sources":["/Users/mac/Desktop/work/wave-frontend/node_modules/@unstoppabledomains/resolution/build/utils/recoverSignature.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/* eslint-disable no-undef */\nvar js_sha3_1 = require(\"js-sha3\");\nvar index_1 = require(\"./index\");\nvar elliptic_1 = require(\"elliptic\");\nvar secp256k1 = new elliptic_1.ec('secp256k1');\nvar bytesLength = function (a) { return (a.length - 2) / 2; };\nvar bytesSlice = function (i, j, bs) {\n    return '0x' + bs.slice(i * 2 + 2, j * 2 + 2);\n};\nvar bytesToNumber = function (hex) { return parseInt(hex.slice(2), 16); };\nvar decodeSignature = function (hex) { return [\n    bytesSlice(64, bytesLength(hex), hex),\n    bytesSlice(0, 32, hex),\n    bytesSlice(32, 64, hex),\n]; };\nvar toChecksum = function (address) {\n    var addressHash = js_sha3_1.keccak256(address.slice(2));\n    var checksumAddress = '0x';\n    for (var i = 0; i < 40; i++) {\n        checksumAddress +=\n            parseInt(addressHash[i + 2], 16) > 7\n                ? address[i + 2].toUpperCase()\n                : address[i + 2];\n    }\n    return checksumAddress;\n};\nexports.hashMessage = function (message) {\n    var messageBytes = index_1.hexToBytes(Buffer.from(message, 'utf8').toString('hex'));\n    var messageBuffer = Buffer.from(messageBytes);\n    var preamble = '\\x19Ethereum Signed Message:\\n' + messageBytes.length;\n    var preambleBuffer = Buffer.from(preamble);\n    var ethMessage = Buffer.concat([preambleBuffer, messageBuffer]);\n    return '0x' + js_sha3_1.keccak256(ethMessage.toString());\n};\nexports.recover = function (message, signature) {\n    var hash = exports.hashMessage(message);\n    var vals = decodeSignature(signature);\n    var vrs = {\n        v: bytesToNumber(vals[0]),\n        r: vals[1].slice(2),\n        s: vals[2].slice(2),\n    };\n    var ecPublicKey = secp256k1.recoverPubKey(Buffer.from(hash.slice(2), 'hex'), vrs, vrs.v < 2 ? vrs.v : 1 - (vrs.v % 2));\n    var publicKey = '0x' + ecPublicKey.encode('hex', false).slice(2);\n    var publicHash = '0x' + js_sha3_1.keccak256(index_1.hexToBytes(publicKey));\n    return toChecksum('0x' + publicHash.slice(-40));\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}